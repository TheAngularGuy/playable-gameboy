"use strict";(self.webpackChunkgameboy=self.webpackChunkgameboy||[]).push([[246],{246:(F,p,l)=>{l.r(p),l.d(p,{MazeComponent:()=>M,MazeModule:()=>k});var d=l(19),v=l(397),h=l(499),C=l(384),i=l(556);function b(n,r){1&n&&i._UZ(0,"div",7)}const y=function(n,r,t,e,o,s){return{bt:n,br:r,bb:t,bl:e,start:o,end:s}};function _(n,r){if(1&n&&(i.TgZ(0,"div",5),i.YNc(1,b,1,0,"div",6),i.qZA()),2&n){const t=r.$implicit,e=i.oxw(3);i.Q6J("ngClass",i.HTZ(2,y,t.top,t.right,t.bottom,t.left,t.start,t.end)),i.xp6(1),i.Q6J("ngIf",t.id==e.player)}}function w(n,r){if(1&n&&(i.TgZ(0,"div",3),i.YNc(1,_,2,9,"div",4),i.qZA()),2&n){const t=r.$implicit,e=i.oxw(2);i.xp6(1),i.Q6J("ngForOf",t)("ngForTrackBy",e.trackByFn)}}function O(n,r){if(1&n&&(i.TgZ(0,"div",1),i.YNc(1,w,2,2,"div",2),i.qZA()),2&n){const t=i.oxw();i.xp6(1),i.Q6J("ngForOf",t.grid)}}let P=(()=>{class n{constructor(){this.trackByFn=(t,e)=>e.id}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-maze-grid"]],inputs:{grid:"grid",player:"player"},decls:1,vars:1,consts:[["class","grid",4,"ngIf"],[1,"grid"],["class","line",4,"ngFor","ngForOf"],[1,"line"],["class","cell",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"cell",3,"ngClass"],["class","player",4,"ngIf"],[1,"player"]],template:function(t,e){1&t&&i.YNc(0,O,2,1,"div",0),2&t&&i.Q6J("ngIf",e.grid)},directives:[d.O5,d.sg,d.mk],styles:['[_nghost-%COMP%]{display:block}.grid[_ngcontent-%COMP%]{--cellSize: 6.4%;--grindScale: 1;--success: #2ecc71;--light: transparent;--dark: #270714;margin:0;padding-top:5%;transform:scale(var(--grindScale))}.grid[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{display:flex;justify-content:center}.grid[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]{background:var(--light);position:relative;width:var(--cellSize);aspect-ratio:1/1;display:flex;justify-content:center;align-items:center}.grid[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;bottom:0;left:0;right:0}.grid[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .start[_ngcontent-%COMP%]{background:var(--light)}.grid[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .end[_ngcontent-%COMP%]{background:var(--success)}.grid[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .bt[_ngcontent-%COMP%]:after{border-top:1px solid var(--dark)}.grid[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .bb[_ngcontent-%COMP%]:after{border-bottom:1px solid var(--dark)}.grid[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .br[_ngcontent-%COMP%]:after{border-right:1px solid var(--dark)}.grid[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]   .bl[_ngcontent-%COMP%]:after{border-left:1px solid var(--dark)}.player[_ngcontent-%COMP%], .other-player[_ngcontent-%COMP%]{content:"";position:absolute;top:20%;bottom:20%;left:20%;right:20%;border-radius:50%;background:#19b5fe;border:1px solid #006699}.player[_ngcontent-%COMP%]{box-shadow:inset 1px 5px 5px -1px #fff9,inset -1px -2px 5px -1px #00000080,0 1px 1px #0000001a,0 2px 2px #0000001a}.other-player[_ngcontent-%COMP%]{background:black}@keyframes move{0%{transform:scale(.7)}to{transform:scale(1)}}'],changeDetection:0}),n})(),z=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({imports:[[d.ez]]}),n})(),u=(()=>{class n{constructor(){this.width=0,this.height=0,this.grid=[],this.visitedCells=[]}getMaxDepth(t,e=0,o=0){if(!t||!t.length)throw new Error("grid.length null");return this.end={depth:0,x:0,y:0},this.visitedCells=[],this.grid=t,this.width=t[0].length,this.height=t.length,this.depthFirst(e,o,0),this.end}depthFirst(t,e,o){this.visitedCells.push(this.grid[e][t].id),o>this.end.depth&&(this.end={depth:o,x:t,y:e}),1===Math.floor(2*Math.random())?(this.moveUp(t,e,o),this.moveDown(t,e,o),this.moveRight(t,e,o),this.moveleft(t,e,o)):(this.moveleft(t,e,o),this.moveRight(t,e,o),this.moveDown(t,e,o),this.moveUp(t,e,o))}moveUp(t,e,o){this.availableMoves(t,e).top&&this.depthFirst(t,e-1,o+1)}moveRight(t,e,o){this.availableMoves(t,e).right&&this.depthFirst(t+1,e,o+1)}moveDown(t,e,o){this.availableMoves(t,e).bottom&&this.depthFirst(t,e+1,o+1)}moveleft(t,e,o){this.availableMoves(t,e).left&&this.depthFirst(t-1,e,o+1)}availableMoves(t,e){return{top:0!==e&&!this.isVisited(this.grid[e-1][t].id)&&!this.grid[e][t].top,left:0!==t&&!this.isVisited(this.grid[e][t-1].id)&&!this.grid[e][t].left,bottom:e!==this.height-1&&!this.isVisited(this.grid[e+1][t].id)&&!this.grid[e][t].bottom,right:t!==this.width-1&&!this.isVisited(this.grid[e][t+1].id)&&!this.grid[e][t].right}}isVisited(t){return this.visitedCells.includes(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac}),n})(),f=(()=>{class n{constructor(){}getRandomIntBetween(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}openLink(t){window.open(t,"_blank")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac}),n})(),m=(()=>{class n{constructor(t,e){this.mazeSolver=t,this.utils=e,this.width=0,this.height=0,this.grid=[],this.depth=0}getMaze(t=32,e=32){this.width=t,this.height=e,this.initChamber(),this.recursiveDivision();const o=this.mazeSolver.getMaxDepth(this.grid);return this.grid[o.y][o.x].end=!0,this.depth=o.depth,this.grid}getDepth(){return this.depth}initChamber(){this.grid=[];for(let t=0;t<this.height;t++){const e=[];for(let o=0;o<this.width;o++)e.push({top:0===t,left:0===o,bottom:t===this.height-1,right:o===this.width-1,id:this.width*t+o});this.grid.push(e)}this.grid[0][0].start=!0}recursiveDivision(){1===this.utils.getRandomIntBetween(0,1)?this.divideY(0,0,this.width,this.height):this.divideX(0,0,this.width,this.height)}divideY(t,e,o,s){if(s-e<=1||o-t<=1)return;const c=this.utils.getRandomIntBetween(e+1,s-1),g=this.utils.getRandomIntBetween(t,o-1);for(let a=t;a<o;a++)a!==g&&(this.grid[c][a].top=!0,this.grid[c-1][a].bottom=!0);this.divideX(t,e,o,c),this.divideX(t,c,o,s)}divideX(t,e,o,s){if(o-t<=1||s-e<=1)return;const c=this.utils.getRandomIntBetween(t+1,o-1),g=this.utils.getRandomIntBetween(e,s-1);for(let a=e;a<s;a++)a!==g&&(this.grid[a][c].left=!0,this.grid[a][c-1].right=!0);this.divideY(t,e,c,s),this.divideY(c,e,o,s)}}return n.\u0275fac=function(t){return new(t||n)(i.LFG(u),i.LFG(f))},n.\u0275prov=i.Yz7({token:n,factory:n.\u0275fac}),n})();var $=l(174);function T(n,r){1&n&&(i.TgZ(0,"span"),i._uU(1,"with perfect score !!"),i.qZA())}function L(n,r){if(1&n&&(i.TgZ(0,"span",4),i._uU(1," You won "),i.YNc(2,T,2,0,"span",5),i.ALo(3,"async"),i._uU(4,"! "),i.qZA()),2&n){const t=i.oxw();i.xp6(2),i.Q6J("ngIf",i.lcZ(3,1,t.perfect$))}}let M=(()=>{class n{constructor(t,e,o){this.mazeGenerator=t,this.buttonsEventsService=e,this.router=o,this.perfect$=new h.X(!1),this.completed$=new h.X(!1),this.grid$=new h.X([]),this.depth$=new h.X(0),this.playerLocation$=new h.X({id:0,x:0,y:0}),this.nbMovements$=new h.X(0)}ngOnInit(){this.startGame()}ngOnDestroy(){var t;null===(t=this.subscription)||void 0===t||t.unsubscribe()}startGame(){var t;null===(t=this.subscription)||void 0===t||t.unsubscribe(),this.playerLocation$.next({id:0,x:0,y:0}),this.grid$.next(this.mazeGenerator.getMaze(12,12)),this.depth$.next(this.mazeGenerator.getDepth()),this.completed$.next(!1),this.nbMovements$.next(0),this.subscription=this.buttonsEventsService.buttonClick.pipe((0,C.b)(e=>{"B"===e&&this.router.navigateByUrl("/"),this.keyCodeToMovementMapper(e)})).subscribe()}movePlayerToNewLocation(t){this.nbMovements$.next(this.nbMovements$.getValue()+1),this.playerLocation$.next(Object.assign({},t)),this.perfect$.next(this.depth$.getValue()===this.nbMovements$.getValue()),this.grid$.getValue()[t.y][t.x].end&&(this.completed$.next(!0),setTimeout(()=>this.startGame(),n.DELAY))}handleKeyboardEvent(t){t.preventDefault(),this.keyCodeToMovementMapper(t.code)}keyCodeToMovementMapper(t){switch(t){case"TOP":case"KeyW":case"ArrowUp":return this.moveUp();case"RIGHT":case"KeyD":case"ArrowRight":return this.moveRight();case"BOTTOM":case"KeyS":case"ArrowDown":return this.moveDown();case"LEFT":case"KeyA":case"ArrowLeft":return this.moveLeft()}}moveUp(){const t=this.playerLocation$.getValue(),e=this.grid$.getValue(),s=e[t.y-1]&&e[t.y-1][t.x];s&&!e[t.y][t.x].top&&this.movePlayerToNewLocation({id:s.id,x:t.x,y:t.y-1})}moveDown(){const t=this.grid$.getValue(),e=this.playerLocation$.getValue(),s=t[e.y+1]&&t[e.y+1][e.x];s&&!t[e.y][e.x].bottom&&this.movePlayerToNewLocation({id:s.id,x:e.x,y:e.y+1})}moveRight(){const t=this.grid$.getValue(),e=this.playerLocation$.getValue(),s=t[e.y][e.x+1];s&&!t[e.y][e.x].right&&this.movePlayerToNewLocation({id:s.id,x:e.x+1,y:e.y})}moveLeft(){const t=this.grid$.getValue(),e=this.playerLocation$.getValue(),s=t[e.y][e.x-1];s&&!t[e.y][e.x].left&&this.movePlayerToNewLocation({id:s.id,x:e.x-1,y:e.y})}}return n.DELAY=1800,n.\u0275fac=function(t){return new(t||n)(i.Y36(m),i.Y36($.h),i.Y36(v.F0))},n.\u0275cmp=i.Xpm({type:n,selectors:[["ng-component"]],hostBindings:function(t,e){1&t&&i.NdJ("keydown",function(s){return e.handleKeyboardEvent(s)},!1,i.Jf7)},decls:12,vars:15,consts:[[1,"wrapper"],[3,"grid","player"],[1,"msg"],["class","won",4,"ngIf"],[1,"won"],[4,"ngIf"]],template:function(t,e){if(1&t&&(i.TgZ(0,"div",0),i._UZ(1,"app-maze-grid",1),i.ALo(2,"async"),i.ALo(3,"async"),i.TgZ(4,"p",2),i.YNc(5,L,5,3,"span",3),i.ALo(6,"async"),i._uU(7),i.ALo(8,"async"),i._UZ(9,"br"),i._uU(10),i.ALo(11,"async"),i.qZA(),i.qZA()),2&t){let o;i.xp6(1),i.Q6J("grid",i.lcZ(2,5,e.grid$))("player",null==(o=i.lcZ(3,7,e.playerLocation$))?null:o.id),i.xp6(4),i.Q6J("ngIf",i.lcZ(6,9,e.completed$)),i.xp6(2),i.hij(" You moved ",i.lcZ(8,11,e.nbMovements$)," times. "),i.xp6(3),i.hij(" Solvable in ",i.lcZ(11,13,e.depth$)," moves. ")}},directives:[P,d.O5],pipes:[d.Ov],styles:['[_nghost-%COMP%]{display:block;height:100%;width:100%}.wrapper[_ngcontent-%COMP%]{height:100%;width:100%;font-family:"Andale Mono",Helvetica,sans-serif}.wrapper[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{font-size:.87rem;margin:5px 0 0;padding-left:5px}.wrapper[_ngcontent-%COMP%]   .won[_ngcontent-%COMP%]{display:inline-block;color:#f0f8ff;font-weight:bolder;background:black;padding:0 7px}'],changeDetection:0}),n})(),k=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({providers:[f,m,u],imports:[[d.ez,z,v.Bz.forChild([{path:"",component:M}])]]}),n})()}}]);